module Test_RS

include(joinpath(@__DIR__,"..", "..", "src", "ZMPBipedRobot.jl"))
import .ZMPBipedRobot as ZMProbot
using RigidBodyDynamics 
using Test 

sleep(0.1) # used for good printing
println("Started test")
Δt = 1e-3
Kp = 10000.0
Kd = 100.0
Ki = 100.0
ctrl = true 
@testset "Robot Simulator" begin 
    # Construct the biped robot which store the geomtrical propreties and the path wanted 
    URDFfileName = "ZMP_2DBipedRobot.urdf"
    br = ZMProbot.BipedRobot(;
        readFile = true,
        URDFfileName = URDFfileName,
        paramFileName = "param_test.jl",
    )

    # Construct the Preview Controller
    pc = ZMProbot.PreviewController(; br = br)

    # Run the Foot Planer Algorithm and get the foot position 
    fp = ZMProbot.FootPlanner(; br = br)

    # Get the ZMP reference trajectory 
    zt = ZMProbot.ZMPTrajectory(; br = br, fp = fp)

    # Convert the ZMP reference trajectory into CoM trajectory
    ct = ZMProbot.CoMTrajectory(; br = br, pc = pc, zt = zt)

    # Get the Swing Foot trajectory 
    sf = ZMProbot.SwingFootTrajectory(; br = br, fp = fp, zt = zt)

    # Get the joint trajectory from the all path 
    ik = ZMProbot.InverseKinematics(; br = br, fp = fp, ct = ct, sf = sf)

    # Store into more convienant variables 
    qr = ik.q_r;
    ql = ik.q_l;
    qref = [ql[:, 1] qr[:, 1] ql[:, 2] qr[:, 2]]

    CoM = reduce(hcat, ct.CoM)
    ZMP = reduce(hcat, zt.ZMP)
    tplot = reduce(vcat, zt.timeVec)
    tend = 0.05      # Simulation time 

    # Construct the robot in the simulation engine 
    rs = ZMProbot.RobotSimulator(;
        fileName = URDFfileName,
        symbolic = false,
        add_contact_points = true,
        add_gravity = true,
        add_flat_ground = true,
    );
    # Generate the visualiser 
    vis = ZMProbot.set_visulalizer(; mechanism = rs.mechanism)

    # Intiial configuration 
    boom = [ 0, 0 ]
    actuators = [ 0, 0, 0, 0 ]
    foot = [ 0, 0 ]
    ZMProbot.set_nominal!(rs, vis, boom, actuators, foot)

    # Simulate the robot 
    controller! = ZMProbot.trajectory_controller!(rs, tplot, qref, Δt, Kp, Ki, Kd, ctrl)
    ts, qs, vs = RigidBodyDynamics.simulate(rs.state, tend, Δt = Δt, controller!);
    
    torque_sim = rs.torques
    @test qs == [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [-1.3031753962641609e-5, -4.90560721318855e-6, -0.0001254642605159546, -0.00012546426051595453, 0.00020354346889521485, 0.00020354346889521463, -9.066929603064193e-5, -9.066929603064166e-5], [-5.805335859317265e-5, -1.963315826329752e-5, -0.0005644157660900375, -0.0005644157660900374, 0.0009308134968324933, 0.0009308134968324926, -0.0004445229997889597, -0.0004445229997889589], [-0.00012443811818898013, -4.417649946910298e-5, -0.0012221208053863116, -0.0012221208053863114, 0.0020482003910754685, 0.002048200391075467, -0.0010415866972180064, -0.0010415866972180053], [-0.00020405862128678853, -7.845304307152831e-5, -0.0020249226223388044, -0.0020249226223388044, 0.0034462726774173477, 0.0034462726774173455, -0.0018497444187204428, -0.0018497444187204415], [-0.00029071289646097093, -0.00012225187711494272, -0.002915426067114354, -0.002915426067114354, 0.0050330819617317515, 0.005033081961731749, -0.002819762381492717, -0.002819762381492716], [-0.00037969921125772214, -0.00017519428089739867, -0.003848981222421601, -0.0038489812224216007, 0.006729298509805256, 0.0067292985098052534, -0.003883962041043015, -0.003883962041043013], [-0.0004674618238060542, -0.00023670304541093754, -0.004790814254886469, -0.004790814254886468, 0.008464478776404688, 0.008464478776404685, -0.004962815617465345, -0.004962815617465343], [-0.0005512991298821158, -0.0003059800339383982, -0.005713727768345381, -0.00571372776834538, 0.010174406032934393, 0.01017440603293439, -0.005980880163798069, -0.005980880163798067], [-0.0006291263084846301, -0.00038199192894676373, -0.006596287044708176, -0.006596287044708175, 0.011799321170818423, 0.01179932117081842, -0.006887707854575492, -0.00688770785457549], [-0.0006992842840562107, -0.0004634643559310041, -0.007421399018911843, -0.007421399018911841, 0.013282744742602735, 0.013282744742602732, -0.007672796576080677, -0.007672796576080675], [-0.0007604898450159707, -0.0005488909421003838, -0.008176999580674289, -0.008176999580674287, 0.014584713243194306, 0.014584713243194302, -0.008315503542642063, -0.008315503542642063], [-0.0008125883998625398, -0.0006366008846299168, -0.008869660133600145, -0.008869660133600143, 0.01579312905871405, 0.015793129058714047, -0.008460685504529906, -0.008460685504529906], [-0.0008556390524327968, -0.0007247314861222529, -0.009499536400186083, -0.009499536400186082, 0.01690678555796227, 0.016906785557962267, -0.008303308013596303, -0.008303308013596305], [-0.0008901366688414359, -0.0008112965071939257, -0.010072614709184477, -0.010072614709184476, 0.017957865495506885, 0.017957865495506882, -0.008069721443058725, -0.008069721443058729], [-0.0009167995784081917, -0.0008942291405232443, -0.010595980093417431, -0.01059598009341743, 0.018977235151885062, 0.01897723515188506, -0.008124582929438672, -0.00812458292943867], [-0.0009364092585753689, -0.0009714495147507556, -0.01107473884705731, -0.011074738847057309, 0.019968877008031283, 0.019968877008031283, -0.00866531924399635, -0.008665319243996343], [-0.0009499264701599647, -0.0010409743587657663, -0.011517666368400412, -0.01151766636840041, 0.020968483360316502, 0.020968483360316505, -0.009545022865214492, -0.009545022865214487], [-0.0009579869441634077, -0.0011009460906791506, -0.011925410462483422, -0.01192541046248342, 0.021942145513996245, 0.021942145513996248, -0.010608142097710337, -0.010608142097710339], [-0.0009611197621260694, -0.0011497494038495016, -0.012300153546604947, -0.012300153546604945, 0.022878715938495272, 0.022878715938495275, -0.011509165492683479, -0.011509165492683488], [-0.0009596421822493322, -0.0011860697068937847, -0.012642121673201036, -0.012642121673201034, 0.02375842761126249, 0.023758427611262494, -0.012123015440294666, -0.012123015440294682], [-0.0009727376703240633, -0.0012093218265302745, -0.01313551865899734, -0.01313551865899734, 0.024879734879782768, 0.02487973487978277, -0.012530675185441927, -0.012530675185441941], [-0.0010112748957157769, -0.001219241587349447, -0.013889194591040382, -0.013889194591040382, 0.026413394912585993, 0.026413394912585996, -0.013165406918059331, -0.013165406918059333], [-0.0010654956265549584, -0.0012156524217649073, -0.01481653527581175, -0.01481653527581175, 0.028241181157376602, 0.02824118115737661, -0.014018476771400232, -0.014018476771400218], [-0.0011278143938696214, -0.0011988153058322126, -0.01584839596807012, -0.01584839596807012, 0.030254389794418735, 0.030254389794418742, -0.015190045986032543, -0.015190045986032526], [-0.0011926056402503681, -0.0011694059678164321, -0.01693315024272258, -0.01693315024272258, 0.032373747604568376, 0.03237374760456838, -0.016429659570154354, -0.016429659570154354], [-0.001255399085070205, -0.0011284395651969315, -0.018027264266584235, -0.018027264266584235, 0.03450594333145282, 0.03450594333145283, -0.017769367249206816, -0.017769367249206827], [-0.0013130569807383084, -0.0010772576853849583, -0.01910145940969525, -0.01910145940969525, 0.03660286064980576, 0.036602860649805766, -0.01890657667544992, -0.018906576675449926], [-0.0013633224464079555, -0.0010174614305971615, -0.020134995632260816, -0.020134995632260816, 0.038637814958141455, 0.03863781495814146, -0.019884427356148995, -0.019884427356149002], [-0.001404816649610183, -0.0009508208658971638, -0.021113965963115648, -0.021113965963115648, 0.04058592894730435, 0.04058592894730436, -0.020642106097202004, -0.020642106097202014], [-0.00143667519245616, -0.0008792229443744063, -0.0220298056834615, -0.0220298056834615, 0.04243942288656316, 0.042439422886563175, -0.021390890815125276, -0.02139089081512528], [-0.0014585866894189622, -0.0008045783013301729, -0.022877785937952252, -0.022877785937952252, 0.044186112424429255, 0.04418611242442927, -0.02214783724759727, -0.022147837247597255], [-0.0014706725854169577, -0.0007288052272516018, -0.023659355867191322, -0.023659355867191322, 0.04585126350464063, 0.04585126350464065, -0.02295764159407118, -0.02295764159407117], [-0.0014733246008384942, -0.0006537029586301191, -0.02437511383763543, -0.02437511383763543, 0.047426902412337366, 0.04742690241233738, -0.023793331375405007, -0.023793331375405017], [-0.0014670277383361406, -0.0005809505185675864, -0.025027435566954016, -0.025027435566954016, 0.04891683754133045, 0.048916837541330464, -0.024680735493817853, -0.024680735493817885], [-0.0014523662994180215, -0.0005120449916805624, -0.025618491677003512, -0.025618491677003512, 0.05031143504432707, 0.05031143504432709, -0.025568853102711217, -0.025568853102711245], [-0.0014301097349192825, -0.0004483423418607951, -0.026155034706154483, -0.026155034706154483, 0.05164040196344023, 0.051640401963440254, -0.02636352268277748, -0.026363522682777495], [-0.0014008118587366888, -0.0003909199393270741, -0.02663702029259931, -0.02663702029259931, 0.05286786675464791, 0.052867866754647934, -0.027152814060895706, -0.027152814060895713], [-0.001365348267880274, -0.00034076282811215924, -0.0270740461096346, -0.0270740461096346, 0.054045625461556515, 0.054045625461556536, -0.027794992535224067, -0.02779499253522407], [-0.0013243139333521652, -0.0002985601324325748, -0.027466660060872564, -0.027466660060872564, 0.055140956514766866, 0.05514095651476689, -0.028422747030486434, -0.028422747030486438], [-0.0012783758394834905, -0.0002648864802040809, -0.027820414362509177, -0.027820414362509177, 0.056171789276000555, 0.056171789276000576, -0.02901896909255699, -0.029018969092557], [-0.0012467840766197198, -0.00024092464187011066, -0.02831960118894836, -0.02831960118894836, 0.05744224627300404, 0.05744224627300406, -0.029706396855604347, -0.029706396855604368], [-0.0012408239746877212, -0.00022750197224658659, -0.02907766217258248, -0.02907766217258248, 0.059155284357296355, 0.059155284357296375, -0.030603181437316655, -0.030603181437316686], [-0.0012512610984352491, -0.00022452338009257457, -0.030010602013487785, -0.030010602013487785, 0.06119204752717322, 0.06119204752717324, -0.03168658579557946, -0.0316865857955795], [-0.0012710965366528187, -0.00023186763993684995, -0.03105330766229578, -0.03105330766229578, 0.06345528645626777, 0.0634552864562678, -0.03292699029889343, -0.03292699029889347], [-0.0012951029050708056, -0.00024938534692204114, -0.03215576159178692, -0.03215576159178692, 0.06586543492557106, 0.06586543492557109, -0.03428799874946772, -0.034287998749467766], [-0.001319445494787419, -0.0002768962691330822, -0.03327994119383948, -0.03327994119383948, 0.06835724699943484, 0.06835724699943486, -0.03572689489899927, -0.03572689489899932], [-0.0013413722982299568, -0.00031417779160130047, -0.03439726917951362, -0.03439726917951362, 0.07087676737405084, 0.07087676737405087, -0.03719691467979877, -0.03719691467979882], [-0.0013589592453343749, -0.0003609427776191454, -0.03548651397474428, -0.03548651397474428, 0.07337858813556736, 0.07337858813556739, -0.038653140852935385, -0.038653140852935426], [-0.0013708999202166965, -0.0004168100423625515, -0.03653206578005892, -0.03653206578005892, 0.07582343839632208, 0.07582343839632211, -0.04006189763827313, -0.04006189763827316], [-0.001376331356189253, -0.00048127131150882375, -0.03752252592311488, -0.03752252592311488, 0.07817611494101186, 0.07817611494101188, -0.041410769187714615, -0.04141076918771464]]
    @test vs == [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [-0.03104502502141848, -0.009814418125110452, -0.3000821673041927, -0.30008216730419257, 0.4901372334556084, 0.49013723345560795, -0.22481428574095225, -0.2248142857409517], [-0.057236864987996856, -0.019640752718480536, -0.562115373772223, -0.562115373772223, 0.9422511880627434, 0.9422511880627429, -0.47960191471440006, -0.4796019147143997], [-0.07417698086259863, -0.029432878108330222, -0.7410097266572631, -0.7410097266572631, 1.274286242445774, 1.2742862424457735, -0.7092406040326139, -0.7092406040326136], [-0.08402954946532638, -0.03908564000695116, -0.8550211724126475, -0.8550211724126473, 1.5065361550530862, 1.506536155053086, -0.8989168775624086, -0.8989168775624083], [-0.08849481755288009, -0.048449399524263775, -0.9185388310297494, -0.9185388310297492, 1.6538625908682192, 1.653862590868219, -1.0298372793880695, -1.0298372793880692], [-0.0888848432753467, -0.05733962487692905, -0.9427720052912659, -0.9427720052912657, 1.7268305661762553, 1.726830566176255, -1.0852505644637787, -1.0852505644637787], [-0.08618995760043992, -0.06554523761908375, -0.9363586200140388, -0.9363586200140386, 1.732827295243718, 1.732827295243718, -1.0598062429396113, -1.0598062429396111], [-0.08113720002760084, -0.07283681764551078, -0.9058947090369952, -0.905894709036995, 1.6770680493658479, 1.6770680493658476, -0.9678858259657571, -0.9678858259657568], [-0.07424082171879649, -0.07897480163956185, -0.8563749876007976, -0.8563749876007974, 1.5633504767215631, 1.563350476721563, -0.8440896660785769, -0.8440896660785766], [-0.06584436412566924, -0.08371821680213003, -0.7915381582968382, -0.791538158296838, 1.3944843225426882, 1.394484322542688, -0.7304451297208101, -0.7304451297208098], [-0.05664794583287691, -0.08687343005819347, -0.7264790492121127, -0.7264790492121127, 1.2807146097183277, 1.2807146097183273, -0.3240839583892471, -0.32408395838924864], [-0.04765482574914665, -0.08826691475043384, -0.6677440016336493, -0.6677440016336493, 1.228225706607332, 1.2282257066073323, 0.24487275331292505, 0.24487275331292532], [-0.03860291199431803, -0.08769991023656627, -0.603258158653073, -0.603258158653073, 1.1128568913959782, 1.1128568913959775, 0.3293073862145144, 0.3293073862145121], [-0.030532086635570048, -0.08513418766563104, -0.5561284904575675, -0.5561284904575675, 1.1263238126040036, 1.1263238126040027, 0.38946225156117653, 0.38946225156117487], [-0.02295065591366568, -0.08044623946768333, -0.5059642022989178, -0.5059642022989179, 1.0714213219652051, 1.0714213219652058, -0.13394269532700823, -0.13394269532700157], [-0.016392807592627883, -0.07373804908592166, -0.4686890688887958, -0.4686890688887959, 1.0928901338694248, 1.0928901338694255, -0.5165898094846704, -0.5165898094846676], [-0.010738209678221857, -0.06509641172004618, -0.43599777888152974, -0.43599777888152985, 1.1079476437939364, 1.1079476437939366, -0.7351230597836595, -0.7351230597836655], [-0.00547304671039501, -0.054684369694600304, -0.39999201419421637, -0.3999920141942166, 1.0595131022151902, 1.0595131022151911, -0.8002074563643349, -0.8002074563643428], [-0.0008565060758692046, -0.04282575382764347, -0.3713516889951301, -0.37135168899513044, 1.050636027038133, 1.050636027038134, -0.42446736968082566, -0.4244673696808308], [0.0037327454699059375, -0.029789316530914732, -0.3357000745465906, -0.335700074546591, 0.9582906072670958, 0.9582906072670969, -0.1892808994909551, -0.18928089949096075], [-0.027833235175800157, -0.01674993156512486, -0.6559240659516059, -0.6559240659516061, 1.5170532044711913, 1.5170532044711909, -0.06629358890877615, -0.06629358890877014], [-0.04767555737398656, -0.003208222903875933, -0.8608656822972655, -0.860865682297266, 1.7902165474215572, 1.7902165474215597, -0.5414484385542918, -0.541448438554274], [-0.0595513000447154, 0.010180468482777085, -1.0062075835124134, -1.006207583512414, 2.1087618512341684, 2.10876185123417, -0.5749760608527925, -0.5749760608527785], [-0.0642288954258061, 0.023218060052337237, -1.0722179704226587, -1.0722179704226589, 2.156733016281346, 2.156733016281345, -1.0724052863583848, -1.0724052863583968], [-0.06469937758472669, 0.035253964211954904, -1.112945426144585, -1.1129454261445852, 2.314639631374486, 2.3146396313744857, -0.8331672557531654, -0.8331672557531847], [-0.06050083914184292, 0.04628836456476805, -1.0917593579105132, -1.0917593579105138, 2.1690770055890662, 2.169077005589069, -1.1746212670054368, -1.1746212670054372], [-0.054529373701579543, 0.0556376637173123, -1.0726516583362051, -1.0726516583362058, 2.230700901923659, 2.2307009019236617, -0.6149252233277188, -0.6149252233277153], [-0.045906529360195514, 0.06350187103888158, -1.0101622715654046, -1.0101622715654048, 2.026186628776082, 2.026186628776081, -0.8007489141584118, -0.8007489141584169], [-0.03702799992406023, 0.06931091710713601, -0.9621731748694342, -0.9621731748694344, 2.0388295093651183, 2.038829509365117, -0.3463726286819631, -0.34637262868196367], [-0.026770955807326757, 0.07342966199452922, -0.8829560014424954, -0.8829560014424961, 1.8151707594609343, 1.8151707594609383, -0.7278849795372765, -0.7278849795372611], [-0.017132324954301677, 0.0754182062936532, -0.8246522077816759, -0.8246522077816764, 1.8054054802434014, 1.8054054802434047, -0.4975824098241144, -0.4975824098241024], [-0.007196490386412313, 0.07571996361161348, -0.7488372832258263, -0.7488372832258263, 1.6312120045444864, 1.6312120045444845, -0.8127654341467979, -0.8127654341468156], [0.001753922461621467, 0.074111272648613, -0.6912331275990703, -0.6912331275990703, 1.607894803589221, 1.6078948035892189, -0.6472202951025618, -0.647220295102584], [0.010667117615506537, 0.07107211067070267, -0.6202352892137107, -0.620235289213711, 1.437148409399253, 1.4371484093992546, -0.921786415026435, -0.9217864150264379], [0.018494162670543837, 0.06645541475750001, -0.5676830612243838, -0.567683061224384, 1.4070563734692099, 1.4070563734692112, -0.7125715597279818, -0.712571559727974], [0.025960172568918333, 0.06075558513563313, -0.5065038664063123, -0.5065038664063123, 1.25902636942832, 1.2590263694283195, -0.8562690865355884, -0.8562690865355811], [0.0324731273409597, 0.05389814161813237, -0.46112302698132734, -0.46112302698132734, 1.2264815634640238, 1.2264815634640236, -0.6428611074783362, -0.6428611074783304], [0.03835649469920792, 0.04629027511598547, -0.41386782381810366, -0.41386782381810366, 1.1330539751439954, 1.1330539751439952, -0.6383726470477495, -0.6383726470477487], [0.04360093739308101, 0.03801975044469675, -0.3722837930656269, -0.372283793065627, 1.0605792521947968, 1.0605792521947965, -0.6143110125801171, -0.6143110125801206], [0.048161351420874014, 0.029258992700415445, -0.33607606264385875, -0.3360760626438588, 1.0031450143305545, 1.0031450143305543, -0.57676577562438, -0.5767657756243869], [0.017030074829310096, 0.01867843977177239, -0.6443629009891282, -0.6443629009891282, 1.5135206161461507, 1.5135206161461503, -0.7953087171421631, -0.795308717142174], [-0.0035692984837695724, 0.008182919759769768, -0.8577460103431014, -0.8577460103431013, 1.8927177216315412, 1.8927177216315405, -0.9944491653730047, -0.9944491653730144], [-0.016137141882223895, -0.0022052805253133185, -0.997269578187152, -0.997269578187152, 2.164577145007807, 2.1645771450078053, -1.1674129790065986, -1.1674129790066055], [-0.022661353839673146, -0.012458160695730386, -1.0797955113101199, -1.0797955113101199, 2.3486236538208436, 2.3486236538208414, -1.3073384318699546, -1.307338431869959], [-0.024711296895311874, -0.022547217516186373, -1.1187672760579122, -1.1187672760579122, 2.4607909929516154, 2.460790992951613, -1.4075612257073966, -1.4075612257073993], [-0.023514441276644538, -0.032437718022769124, -1.124822920036186, -1.124822920036186, 2.5138391612607394, 2.513839161260737, -1.4624055990054976, -1.4624055990054974], [-0.020017911199409318, -0.04207779527823754, -1.106289934096152, -1.1062899340961518, 2.517636114820689, 2.5176361148206867, -1.4700819809924832, -1.4700819809924794], [-0.014937862931383664, -0.05138904388315808, -1.0695949178275546, -1.0695949178275543, 2.4794650039018338, 2.4794650039018316, -1.4366779264109166, -1.4366779264109082], [-0.008799460871459365, -0.06026120509180854, -1.0196071254294388, -1.0196071254294385, 2.4043745817725197, 2.404374581772517, -1.3787087312926687, -1.37870873129266], [-0.001969284664331461, -0.06855028963321272, -0.959922053495068, -0.9599220534950678, 2.2954978597198337, 2.2954978597198306, -1.3213472208476533, -1.3213472208476444]]
    @test torque_sim == Array[[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, -0.9978785337672311, -0.9978785337672311, -0.08290756424715556, -0.08290756424715556, 0.0, 0.0], [0.0, 0.0, -0.5332382937520359, -0.5332382937520358, 0.0038420653271056815, 0.0038420653271055705, 0.0, 0.0], [0.0, 0.0, -0.29079415684121734, -0.2907941568412171, 0.044859324203731295, 0.044859324203731385, 0.0, 0.0], [0.0, 0.0, -0.11048474183712287, -0.11048474183712259, 0.07230121394709468, 0.07230121394709477, 0.0, 0.0], [0.0, 0.0, 0.021954428871922893, 0.021954428871922893, 0.08993478878227261, 0.08993478878227268, 0.0, 0.0], [0.0, 0.0, 0.11876364497294677, 0.11876364497294692, 0.101147381949487, 0.10114738194948711, 0.0, 0.0], [0.0, 0.0, 0.19038425224065453, 0.19038425224065475, 0.10896681637696459, 0.10896681637696469, 0.0, 0.0], [0.0, 0.0, 0.2456165633997589, 0.2456165633997582, 0.11605700263722171, 0.11605700263722149, 0.0, 0.0], [0.0, 0.0, 0.29176524285134764, 0.2917652428513474, 0.12471495512772733, 0.12471495512772732, 0.0, 0.0], [0.0, 0.0, 0.3348249493294781, 0.3348249493294783, 0.13689588718551496, 0.13689588718551507, 0.0, 0.0], [0.0, 0.0, 0.3573213456786537, 0.3573213456786538, 0.14557318015674253, 0.14557318015674256, 0.0, 0.0], [0.0, 0.0, 0.4072162678504001, 0.4072162678504003, 0.1667595210843435, 0.16675952108434364, 0.0, 0.0], [0.0, 0.0, 0.4353002296391381, 0.43530022963913834, 0.17844443727269593, 0.17844443727269607, 0.0, 0.0], [0.0, 0.0, 0.4297181206523318, 0.42971812065233145, 0.17683059662141093, 0.1768305966214108, 0.0, 0.0], [0.0, 0.0, 0.4563061538097896, 0.4563061538097899, 0.1889660537276943, 0.18896605372769443, 0.0, 0.0], [0.0, 0.0, 0.42868186647283757, 0.4286818664728377, 0.17732426650078897, 0.17732426650078909, 0.0, 0.0], [0.0, 0.0, 0.4363283710194508, 0.43632837101945066, 0.1807387533097958, 0.18073875330979566, 0.0, 0.0], [0.0, 0.0, 0.4164016692781503, 0.41640166927814987, 0.1712027448565533, 0.17120274485655307, 0.0, 0.0], [0.0, 0.0, 0.39567223339181723, 0.3956722333918168, 0.1618538268209384, 0.1618538268209383, 0.0, 0.0], [0.0, 0.0, 0.40074742225209264, 0.4007474222520918, 0.16371757949856797, 0.16371757949856763, 0.0, 0.0], [0.0, 0.0, 0.3804830292500279, 0.38048302925002786, 0.15515437464176265, 0.15515437464176254, 0.0, 0.0], [0.0, 0.0, -0.23882643753989308, -0.23882643753989263, 0.14532595961658284, 0.14532595961658284, 0.0, 0.0], [0.0, 0.0, -0.008572276672877854, -0.008572276672875967, 0.17748666495157056, 0.1774866649515711, 0.0, 0.0], [0.0, 0.0, 0.21827280545962413, 0.2182728054596232, 0.22201353578547586, 0.22201353578547547, 0.0, 0.0], [0.0, 0.0, 0.31418188572614547, 0.31418188572614525, 0.22195820948818926, 0.22195820948818903, 0.0, 0.0], [0.0, 0.0, 0.44762370913861826, 0.4476237091386192, 0.24724451707518494, 0.24724451707518524, 0.0, 0.0], [0.0, 0.0, 0.4565039584664102, 0.45650395846641045, 0.22745711249685327, 0.2274571124968533, 0.0, 0.0], [0.0, 0.0, 0.5503851129624153, 0.5503851129624153, 0.25039171002419497, 0.2503917100241948, 0.0, 0.0], [0.0, 0.0, 0.5073506121502005, 0.5073506121502002, 0.21934324414922352, 0.2193432441492233, 0.0, 0.0], [0.0, 0.0, 0.5562486047109604, 0.5562486047109607, 0.231648519111494, 0.2316485191114941, 0.0, 0.0], [0.0, 0.0, 0.4838377863965576, 0.4838377863965581, 0.19473082142745532, 0.1947308214274556, 0.0, 0.0], [0.0, 0.0, 0.5067959807807199, 0.5067959807807183, 0.2011371524074549, 0.20113715240745403, 0.0, 0.0], [0.0, 0.0, 0.4265557375429314, 0.42655573754292975, 0.16417597251024668, 0.16417597251024593, 0.0, 0.0], [0.0, 0.0, 0.41859399633630856, 0.4185939963363085, 0.15952683122300465, 0.15952683122300468, 0.0, 0.0], [0.0, 0.0, 0.34041140640754675, 0.3404114064075472, 0.12547707652609352, 0.12547707652609372, 0.0, 0.0], [0.0, 0.0, 0.3313091122019687, 0.3313091122019674, 0.121973411664869, 0.12197341166486839, 0.0, 0.0], [0.0, 0.0, 0.2640537977937781, 0.26405379779377647, 0.09318841840403161, 0.09318841840403091, 0.0, 0.0], [0.0, 0.0, 0.2507117067118651, 0.25071170671186416, 0.0887560869113652, 0.0887560869113648, 0.0, 0.0], [0.0, 0.0, 0.19598108047305507, 0.19598108047305451, 0.06546898672294482, 0.0654689867229446, 0.0, 0.0], [0.0, 0.0, 0.17014538308114896, 0.1701453830811482, 0.05544124100230667, 0.05544124100230633, 0.0, 0.0], [0.0, 0.0, 0.1423486979055577, 0.14234869790555688, 0.04424545030533243, 0.04424545030533202, 0.0, 0.0], [0.0, 0.0, -0.5091467481118486, -0.5091467481118497, 0.017941506342799743, 0.01794150634279927, 0.0, 0.0], [0.0, 0.0, -0.2740893971683359, -0.2740893971683367, 0.052241617289731895, 0.05224161728973155, 0.0, 0.0], [0.0, 0.0, -0.10354868305191434, -0.10354868305191545, 0.07222601607723417, 0.07222601607723375, 0.0, 0.0], [0.0, 0.0, 0.016618461729414835, 0.016618461729415446, 0.08145524988015616, 0.08145524988015636, 0.0, 0.0], [0.0, 0.0, 0.0979515114839421, 0.0979515114839417, 0.08283997695192236, 0.0828399769519222, 0.0, 0.0], [0.0, 0.0, 0.14991670005762334, 0.14991670005762303, 0.07879139715693638, 0.07879139715693625, 0.0, 0.0], [0.0, 0.0, 0.18037636242198143, 0.18037636242198113, 0.0713611338228896, 0.07136113382288944, 0.0, 0.0], [0.0, 0.0, 0.19595043762863304, 0.19595043762863235, 0.062345815873464695, 0.06234581587346448, 0.0, 0.0], [0.0, 0.0, 0.20228029801426925, 0.20228029801426836, 0.05335802567312444, 0.05335802567312412, 0.0, 0.0], [0.0, 0.0, 0.20423701671722871, 0.20423701671722821, 0.04588091889282369, 0.04588091889282356, 0.0, 0.0]]
end 

sleep(0.1) # used for good printing
println("End test")

end # End Main Module 
